# Electron API

Electron API 是 Electron 框架提供的一系列接口和模块，用于构建跨平台的桌面应用程序。Electron 通过将 Chromium 和 Node.js 嵌入到其二进制文件中，使得开发者可以使用 Web 技术（HTML、CSS 和 JavaScript）来开发桌面应用，而无需考虑底层操作系统的复杂性。以下是对 Electron API 的详细解释：

## 一、Electron API 的主要模块

Electron API 分为多个模块，每个模块都提供了一组特定的功能和接口。以下是一些关键的模块及其功能：

### **app 模块**：

- 控制应用程序的事件生命周期，如启动、退出、窗口管理等。
- 提供了一系列方法和事件，允许开发者控制应用程序的行为和处理用户交互。

Electron 的 `app` 模块是主进程中的一个核心模块，它负责管理应用程序的生命周期以及执行与应用程序整体行为相关的操作。以下是对 `app` 模块的详细介绍：

#### 一、主要功能

1. **生命周期管理**：

   - `app` 模块提供了一系列事件，允许开发者在应用程序的不同生命周期阶段执行特定的任务。例如，在应用程序启动完成后执行初始化任务，在应用程序退出前执行清理任务等。
   - 常用的生命周期事件包括 `ready`、`before-quit`、`will-quit`、`quit` 和 `window-all-closed` 等。

2. **窗口管理**：

   - 虽然 `app` 模块本身不直接创建窗口，但它与窗口管理密切相关。例如，在 `ready` 事件中，开发者通常会创建主窗口。
   - `app` 模块还提供了一些与窗口相关的功能，如隐藏、显示所有窗口，以及将应用程序窗口置于前台等。

3. **系统交互**：
   - `app` 模块允许应用程序与操作系统进行交互，如设置登录项（在用户登录时自动启动应用程序）、控制 Dock 图标（在 macOS 上）等。

#### 二、常用方法和事件

##### 方法

- `app.quit()`：退出应用程序。调用此方法将触发应用程序的生命周期事件，允许进行清理任务和保存状态。
- `app.exit(exitCode)`：立即终止应用程序，并可指定退出代码。可以在应用程序需要立即退出时进行处理。
- `app.relaunch(options)`：重新启动应用程序。可以在应用程序重新启动之前执行清理任务或设置选项。
- `app.isReady()`：检查应用程序是否已准备好创建浏览器窗口。返回一个布尔值，指示应用程序的就绪状态。
- `app.whenReady()`：返回一个 Promise，当应用程序准备好创建浏览器窗口时解析。可以使用 async/await 或 .then() 来等待应用程序就绪后执行其他任务。
- `app.focus()`、`app.hide()`、`app.show()`：分别用于将应用程序窗口置于前台并获取焦点、隐藏和显示应用程序的所有窗口。
- `app.setBadgeCount(count)`：在 macOS 上，用于在应用程序的 Dock 图标上显示一个小红圈，表示未读消息或通知的数量。
- `app.dock.hide()` 和 `app.dock.show()`：在 macOS 上，分别用于隐藏和显示应用程序的 Dock 图标。
- `app.requestSingleInstanceLock()`：用于限制应用程序的实例数，防止用户同时运行多个实例。

##### 事件

- `ready`：当 Electron 完成初始化并准备好创建浏览器窗口时触发。
- `before-quit`：当应用程序开始退出但在关闭所有窗口之前触发。
- `will-quit`：当应用程序将要退出时触发。
- `quit`：当应用程序退出时触发。
- `window-all-closed`：当所有应用程序的窗口都被关闭时触发（注意，在某些操作系统上，如果应用程序是默认情况下保持运行的，即使所有窗口都已关闭，这个事件也可能不会触发）。

#### 三、使用示例

```javascript
const { app, BrowserWindow } = require("electron");

app.on("ready", () => {
  console.log("应用程序初始化已完成");
  let mainWindow = new BrowserWindow({ width: 800, height: 600 });
  // 加载 HTML 页面等
});

app.on("before-quit", () => {
  console.log("应用程序开始退出");
  // 执行清理任务等
});

app.on("quit", () => {
  console.log("应用程序退出");
  // 执行最终的清理任务或保存状态
});
```

#### 四、注意事项

- 有些事件和方法可能在不同的操作系统上表现不同，开发者需要注意这些差异并进行相应的处理。
- `app` 模块提供的 API 是 Electron 应用程序的重要组成部分，熟练掌握这些 API 可以帮助开发者更加高效地开发 Electron 应用程序。

综上所述，`app` 模块是 Electron 应用程序中不可或缺的组成部分，它提供了丰富的功能和灵活的事件机制，帮助开发者更好地控制和管理应用程序的生命周期和行为。

2. **BrowserWindow 模块**：

   - 用于创建和控制应用程序的窗口。
   - 开发者可以使用它来创建窗口、加载和显示 HTML 页面、处理窗口事件，以及在窗口之间进行导航等。

3. **ipcMain 和 ipcRenderer 模块**：

   - 实现了主进程和渲染进程之间的通信机制。
   - ipcMain 模块在主进程中使用，用于监听和处理从渲染进程发送过来的消息。
   - ipcRenderer 模块在渲染进程中使用，用于向主进程发送消息并接收主进程的响应。

4. **dialog 模块**：

   - 提供创建本地系统对话框的功能，如打开文件对话框、保存文件对话框和消息框等。
   - 允许开发者与用户进行交互并获取所需的信息。

5. **Menu 和 MenuItem 类**：

   - 用于创建自定义菜单和上下文菜单。
   - 开发者可以使用这些类来定义应用程序菜单栏的结构和行为，以及在特定元素上显示上下文菜单。

6. **shell 模块**：

   - 提供了一些与系统外壳（shell）交互的功能。
   - 如打开外部链接、执行系统默认的文件操作（如打开文件夹或发送文件到废纸篓等）。

7. **File 模块**：
   - 允许开发者对文件系统进行操作，包括读取、写入、重命名、删除文件等操作。
   - 还提供了一些关于文件和目录的信息查询方法。

## 二、Electron API 的其他功能

除了上述主要模块外，Electron API 还提供了许多其他功能，以满足开发者的不同需求：

- **autoUpdater**：使应用程序能够自动更新。
- **clipboard**：在应用程序剪贴板上执行复制和粘贴操作。
- **globalShortcut**：用于全局注册键盘快捷键，即使应用在后台运行或未被激活时也能响应。
- **net**：使用 Chromium 的原生网络库发出 HTTP/HTTPS 请求。
- **powerMonitor**：监视电源状态的改变。
- **systemPreferences**：获取系统偏好设置。
- **Tray**：添加图标和上下文菜单到系统通知区。

## 三、Electron API 的使用方式

在 Electron 应用程序中，`main.js` 文件通常是主进程的入口点，它负责创建和管理窗口、处理应用程序的生命周期事件等。而渲染进程则负责显示用户界面和处理用户交互，它们通常包含在 HTML 文件中，并使用 JavaScript 和 CSS 进行样式和逻辑的控制。

开发者可以通过 `require` 语句来引入 Electron 的各个模块，并使用它们提供的方法和属性来构建应用程序。例如，使用 `BrowserWindow` 模块来创建一个新的窗口，使用 `ipcMain` 和 `ipcRenderer` 模块来实现主进程和渲染进程之间的通信等。

## 四、Electron API 的优势

Electron API 的优势在于它允许开发者使用熟悉的 Web 技术来构建桌面应用程序，同时又能利用 Node.js 的强大功能来访问底层操作系统和硬件资源。这使得 Electron 成为了构建跨平台桌面应用程序的流行选择之一。此外，Electron 社区还提供了丰富的资源和插件，以帮助开发者更加高效地构建和部署应用程序。
