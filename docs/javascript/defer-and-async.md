# defer 和 async 区别

`defer`和`async`是 HTML 中`<script>`标签的两个重要属性，它们用于控制浏览器如何加载和执行外部脚本。以下是这两个属性的详细区别：

## 1. 执行时机

- **async**：当使用`async`属性时，脚本会在加载完成后立即执行，而不会等待文档解析完成。这意味着，如果多个`<script>`标签都使用了`async`属性，它们的执行顺序是不确定的，谁先加载完成谁就先执行。此外，`async`脚本的执行可能会中断页面的解析过程，直到脚本执行完毕。
- **defer**：使用`defer`属性时，脚本会在浏览器解析完文档后按顺序执行。即如果脚本 A 在脚本 B 之前出现在 HTML 中，并且两者都使用了`defer`属性，那么脚本 A 将在脚本 B 之前执行。`defer`脚本的执行不会中断页面的解析过程，因为它们会在文档解析完成后才执行。

## 2. 加载方式

- **async**和**defer**：两者都是异步加载脚本的，即脚本的加载不会阻塞页面的解析和其他资源的加载。但是，它们的执行时机有所不同。

## 3. 依赖关系

- **async**：由于执行时机不确定，`async`属性通常适合那些不依赖其他脚本的独立模块。例如，一些可选的用户界面增强功能或分析工具等。
- **defer**：`defer`属性适用于那些需要按顺序执行的脚本，尤其是当脚本之间存在依赖关系时。例如，一个大型的应用或库，其初始化代码依赖于其他几个模块。

## 4. 适用场景

- **async**：对于一些小型且独立的脚本，使用`async`能够提高页面加载速度，并尽快地激活这些脚本的功能。
- **defer**：对于那些需要在页面完全解析完成后才执行的脚本，使用`defer`能确保脚本按预期顺序执行，从而避免因执行顺序不当导致的错误。

## 5. 兼容性

- **async**和**defer**：两者都具有良好的浏览器兼容性，几乎所有现代浏览器都支持这两个属性。

## 6. 注意事项

- `async`和`defer`属性仅适用于外部脚本，即通过`src`属性指向外部 JavaScript 文件的脚本。对于内联脚本（即直接在`<script>`标签内编写的脚本），这两个属性是无效的。
- 如果`<script>`标签同时包含`async`和`defer`属性，浏览器会忽略`defer`属性，只按照`async`属性的规则来执行脚本。

综上所述，`defer`和`async`属性的主要区别在于加载和执行时机以及是否保证执行顺序。在实际开发中，应根据脚本的依赖关系和执行需求选择合适的属性。
